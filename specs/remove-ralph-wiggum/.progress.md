---
spec: remove-ralph-wiggum
created: 2026-02-05
---

# Progress: remove-ralph-wiggum

## Completed Tasks

- [x] 1.1 Add loop control logic to stop-watcher.sh - 62330f3
- [x] 1.2 Simplify implement.md to write state directly - 45d50b5
- [x] 1.3 Simplify cancel.md to delete files only - 1cf7899
- [x] 1.4 Remove ralph-loop references from skills and documentation - 1d7f66f
- [x] 1.5 POC Checkpoint - bed443f
- [x] 2.1 Extract coordinator prompt to reusable function/template - (no changes needed)
- [x] 2.2 Add error handling for edge cases - (no changes needed)
- [x] 2.3 Update spec-executor documentation - (2 references updated)
- [x] 3.1 Set up bats-core test infrastructure - pending
- [x] 3.2 Add stop-hook unit tests - pending
- [x] 3.3 Add state management tests - pending
- [x] 4.1 Bump version to 3.0.0 - pending
- [x] 4.2 Add GitHub Actions CI for bats tests - 3fed6ff
- [x] 4.3 Run shellcheck on all scripts - (no changes needed - all scripts pass)
- [x] 4.4 [VERIFY] Local quality check - (all checks pass)
- [x] 4.5 Create PR and verify CI - PR #85 (all CI green)

## Current Task

All tasks complete

## Learnings

### Synthesis Insights (Quick Mode)

- Current stop-watcher.sh already reads state with jq, validates JSON - just needs loop control output added
- implement.md is 1255 lines - most is coordinator prompt, which can be reused in stop-hook
- cancel.md skill invocation is single line, trivial to remove
- Path resolver already sourced in stop-watcher - spec path resolution works
- Two existing CI workflows: version check and spec file check - can use as template for bats
- No existing bats tests - starting fresh with test infrastructure

### POC Verification Results

- stop-watcher.sh: Has loop control (phase=execution, taskIndex < totalTasks check, continuation prompt output)
- implement.md: Self-contained coordinator prompt (1200+ lines), no ralph-loop skill calls
- cancel.md: Simplified to file deletion only, no skill invocations
- No ralph-loop:ralph-loop or ralph-wiggum@ references in plugins/ralph-specum/

### Codebase Patterns Found

- Hook output format: scripts output to stdout, errors to stderr
- State file location: `$CWD/$SPEC_PATH/.ralph-state.json` (resolved path)
- Settings check: YAML frontmatter parsing with sed/awk
- jq guards: `command -v jq >/dev/null 2>&1 || exit 0`

### Scope Decisions

- Keeping state file schema unchanged (no breaking state changes)
- Coordinator prompt will be extracted/templated in Phase 2, not POC
- Recovery mode preserved (existing in state schema)
- .progress.md preserved by cancel (history value) - spec directory still removed

### Task 2.1 Findings

- Prompts are ALREADY DRY and maintainable - no extraction needed
- implement.md: Full 1100+ line coordinator prompt (loaded once at start)
- stop-watcher.sh: 6-line minimal continuation hint (resume after session stop)
- These serve different purposes - stop-hook doesn't need full prompt, just resume instructions
- shellcheck passes on all .sh files (only SC1091 info about sourced files)

## Next

All tasks complete - PR ready for review
